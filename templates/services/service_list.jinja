{% extends "base.jinja" %}
{% block title %}Tous les services{% endblock %}
{% block contenu %}

<div class="container my-4">
  <h1 class="h3 mb-4 text-primary fw-bold">Tous les services</h1>

  <!-- Barre de recherche -->
  <div class="row mb-4">
    <div class="col-md-6 position-relative">
      <input class="form-control shadow-sm" type="search" id="recherche" autocomplete="off" aria-label="Recherche"
        placeholder="üîç Rechercher un service‚Ä¶">
      <div id="chargement"
        class="spinner-border text-primary d-none position-absolute top-50 end-0 translate-middle-y me-3"
        style="width: 1rem; height: 1rem;">
        <span class="visually-hidden">Chargement...</span>
      </div>
      <ul id="resultats-recherche"
        class="list-group position-absolute top-100 start-0 w-100 z-3 d-none mt-1 shadow-sm">
      </ul>
    </div>
  </div>

  <!-- Liste des services -->
    <div id="liste-services" class="row g-4">
     
  </div>
  <div id="pied-page-services" class="text-center text-muted mt-4 d-none">
      Tous les services sont affich√©s.
  </div>
  

  <div id="message-aucun-service" class="d-none text-muted fst-italic">
      Aucun service trouv√©.
  </div>

  {# <div class="row g-4">
    {% if services %} #}
      {# {% for s in services %}
      <div class="col-md-4">
        <div class="card h-100 shadow-sm border-0">

          <!-- Image -->
          {% set images_src = url_for('static', filename='images/' + s.nom_images) if s.nom_images else url_for('static', filename='images/default_service.png') %}
          <a href="{{ url_for('service.service_detail', service_id=s.id_service) }}">
            <img class="card-img-top object-fit-cover rounded-top" style="height: 200px;"
              src="{{ url_for('static', filename='images/ajouts/' ~ s.nom_image) }}" alt="{{ s.titre }}">
          </a>

          <!-- Contenu -->
          <div class="card-body">
            <h5 class="card-title mb-2 fw-semibold">{{ s.titre }}</h5>
            <p class="small text-muted mb-3">
              <i class="bi bi-tag"></i> {{ s.nom_categorie }} ‚Ä¢ 
              <i class="bi bi-geo-alt"></i> {{ s.localisation }}
            </p>

            <!-- Boutons -->
            {% if session.get("id_utilisateur") %}
              {% if s.id_utilisateur == session["id_utilisateur"] or session["role"] == "admin" %}
                <a href="{{ url_for('service.edit_service', service_id=s.id_service) }}"
                  class="btn btn-outline-primary w-100 mb-2">Modifier</a>

                <button type="button" class="btn btn-outline-danger w-100" data-bs-toggle="modal"
                  data-bs-target="#supprimerServiceModal{{ s.id_service }}">
                  Supprimer
                </button>

                <!-- Modal suppression -->
                <div class="modal fade" id="supprimerServiceModal{{ s.id_service }}" tabindex="-1"
                  aria-labelledby="modalLabel{{ s.id_service }}" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="modalLabel{{ s.id_service }}">Confirmer la suppression</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                      </div>
                      <div class="modal-body">
                        √ätes-vous s√ªr(e) de vouloir supprimer le service "<strong>{{ s.titre }}</strong>" ?
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                        <form action="{{ url_for('service.supprimer_service', id_service=s.id_service) }}" method="post" style="display:inline;">
                          <button type="submit" class="btn btn-danger">Supprimer</button>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>

              {% elif s.actif %}
                <a href="{{ url_for('reservation.formulaire_reservation', id_service=s.id_service) }}"
                  class="btn btn-outline-success w-100">R√©server</a>
              {% endif %}
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %} #}
    {# {% else %}
      <p class="text-muted fst-italic">Aucun service trouv√©.</p>
    {% endif %}
  </div> #}
</div>

{% endblock %}
{% block scripts %}
    <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
    <script src="{{ url_for('static', filename='js/service.js') }}"></script>

{% endblock %}
